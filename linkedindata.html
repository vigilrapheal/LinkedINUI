<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <title>Document</title>
    <!-- <style>
        .wrap {
            width: 100%;
        }

        .wrap table {
            width: 100%;
            table-layout: fixed;
        }

        table tr td {
            padding: 5px;
            border: 1px solid #eee;
            width: 100%;
            word-wrap: break-word;
        }

        table.head tr td {
            background: #eee;
        }

        .inner_table {
            height: 400px;
            overflow-y: auto;
        }
    </style> -->
    <style>
        /* .thead-dark thead {
            width: 97%;
        } */

        /* .thead-dark tbody {
            height: 230px;
            overflow-y: auto;
            width: 100%;
        } */

        /* .thead-dark thead,
        .thead-dark tbody,
        .thead-dark tr,
        .thead-dark td,
        .thead-dark th {
            display: block;
        } */

        /* .thead-dark tbody td,
        .thead-dark thead>tr>th {
            float: left; 
            border-bottom-width: 0;
        } */
    </style>
</head>

<body>
    <!-- <div class="wrap">
        <table class="head">
            <tr>
                <td>Head 1</td>
                <td>Head 1</td>
                <td>Head 1</td>
            </tr>
        </table>
        <div class="inner_table">
            <table>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>

                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
                <tr>
                    <td>Body 1</td>
                    <td>Body 1</td>
                    <td>Body 1</td>
                </tr>
            </table>
        </div>
    </div> -->

    <div class="container">
        <div class="row">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>
                        LinkedIn Data
                    </h4>
                </div>
                <table class="table table-fixed" border="1">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Location</th>
                            <th colspan="3" align="center">Experience</th>
                            <th colspan="3">Education</th>
                            <th>Position</th>
                            <th>Profile_url</th>
                            <th>Skills</th>
                            <th>Industry</th>
                            <th>Summary</th>
                        </tr>
                        <tr>
                            <th colspan="3"></th>
                            <th>Job Title</th>
                            <th>Company</th>
                            <th>Duration</th>
                            <th>University</th>
                            <th>Degree</th>
                            <th>Year</th>
                            <th colspan="5"></th>

                        </tr>
                    </thead>
                    <tbody>
                        <!-- <tr>
                            <td>1</td>
                            <td rowspan="2">Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr>
                        <tr>
                            <td>1</td>

                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>1</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                            <td>Mike Adams</td>
                            <td>23</td>
                        </tr> -->
                    </tbody>
                </table>


                <!-- <table class="table thead-dark">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">First</th>
                            <th scope="col">Last</th>
                            <th scope="col">Handle</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">1</th>
                            <td>Mark</td>
                            <td>Otto</td>
                            <td>@mdo</td>
                        </tr>
                        <tr>
                            <th scope="row">2</th>
                            <td>Jacob</td>
                            <td>Thornton</td>
                            <td>@fat</td>
                        </tr>
                        <tr>
                            <th scope="row">3</th>
                            <td>Larry</td>
                            <td>the Bird</td>
                            <td>@twitter</td>
                        </tr>
                    </tbody>
                </table> -->

            </div>
        </div>
    </div>
    <script>
        var totalCounter = 1;
        $(document).ready(function () {

            jQuery(function ($) {
                $('tbody').on('scroll', function () {
                    if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
                        alert('end reached');
                    }
                })
            });

            localStorage.setItem("pageNumber", 0);

            var intervalID;
            $.get("http://10.20.0.61:8009/getLinkedinDetails?page=" + localStorage.getItem("pageNumber") + "&size=10", function (data) {
                // console.log(data);
                displayContent(data);
            });
            intervalID = setInterval(function () {

                $.get("http://10.20.0.61:8009/getLinkedinDetails?page=" + localStorage.getItem("pageNumber") + "&size=10", function (data) {
                    // console.log(data);
                    if (data.number === data.totalPages) {
                        setTimeout(function () {
                            clearInterval(intervalID);
                        });
                    }
                    displayContent(data);
                })
            }, 1000);
        });

        function displayContent(data) {
            var trContent = "<tr>";

            "<td>1</td><td rowspan=\"2\">Mike Adams</td>"
                + "<td>23</td><td>1</td><td>Mike Adams</td><td>23</td><td>1</td>"
                + "<td>Mike Adams</td><td>23</td><td>23</td><td>Mike Adams</td>"
                + "<td>23</td><td>Mike Adams</td><td>23</td></tr>"

            var contentArray = data.content;

            $.each(contentArray, function (key, value) {
                var trContent = "<tr>";
                console.log(key);
                var firstTake = true;
                var experinceObject = JSON.parse(value.experience);
                var arrayList = experinceObject.myArrayList;
                trContent += "<td>" + (totalCounter++) + "</td>";//slno
                // if (firstTake === "true" || firstTake || firstTake === true)
                //     trContent += "<td rowspan=\"" + arrayList.length + "\">" + value.name + "</td>";//name

                trContent += "<td>" + value.name + "</td>";//name

                trContent += "<td>" + value.location + "</td>";//location

                // trContent+="<td>"+value.name+"</td>";

                //experience

                var allJobTitle = "";
                var allCompany = "";
                var allexperience = "";

                $.each(arrayList, function (expKey, expValue) {
                    if (firstTake === "true" || firstTake || firstTake === true)
                        firstTake = false;
                    var expContent = expValue.map;

                    allJobTitle += (expKey + 1) + ") " + expContent.jobTitle + "\n\n";

                    allCompany += expContent.company + "\n\n";

                    allexperience += expContent.experience + "\n\n";

                    // trContent += "<td>" + expContent.jobTitle + "</td>";//jobTitle
                    // trContent += "<td>" + expContent.company + "</td>";//company
                    // trContent += "<td>" + expContent.experience + "</td>";//duration
                });

                trContent += "<td>" + allJobTitle.trim() + "</td>";//jobTitle

                trContent += "<td>" + allCompany.trim() + "</td>";//Company

                trContent += "<td>" + allexperience.trim() + "</td>";//duration

                var educationObject = JSON.parse(value.education);

                arrayList = educationObject.myArrayList;

                var allUniversities = "";
                var allDegrees = "";
                var allyears = "";
                //education
                $.each(arrayList, function (eduKey, eduValue) {
                    if (firstTake === "true" || firstTake || firstTake === true)
                        firstTake = false;
                    var eduContent = eduValue.map;

                    allUniversities += (eduKey + 1) + ") " + eduContent.university + "\n\n";

                    allDegrees += (eduKey + 1) + ") " + eduContent.degree + "\n\n";

                    allyears += (eduKey + 1) + ") " + eduContent.year + "\n\n";

                    // trContent += "<td>" + eduContent.university + "</td>";//university
                    // trContent += "<td>" + eduContent.degree + "</td>";//degree
                    // trContent += "<td>" + eduContent.year + "</td>";//year
                });

                trContent += "<td>" + allUniversities.trim() + "</td>";//university

                trContent += "<td>" + allDegrees.trim() + "</td>";//degree

                trContent += "<td>" + allyears.trim() + "</td>";//years


                trContent += "<td>" + value.position + "</td>";

                trContent += "<td>" + value.profileUrl + "</td>";

                trContent += "<td>" + value.skills + "</td>";

                trContent += "<td>" + value.industry + "</td>";

                trContent += "<td>" + value.summary + "</td>";

                // console.log(trContent);

                trContent += "</tr>";
                $('tbody').append(trContent);
                trContent = "";
                localStorage.setItem("pageNumber", ((data.number) + 1));
            });
        }


    </script>
</body>

</html>